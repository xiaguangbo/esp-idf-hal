<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Encrypt or decrypt a message fragment in an active AEAD operation."><title>psa_aead_update in esp_idf_sys - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-e935ef01ae1c1829.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="esp_idf_sys" data-themes="" data-resource-suffix="" data-rustdoc-version="1.78.0-nightly (3406ada96 2024-02-21)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-4c98445ec4002617.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-c37d3936c59ababd.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../esp_idf_sys/index.html">esp_idf_sys</a><span class="version">0.34.1</span></h2></div><div class="sidebar-elems"></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../esp_idf_sys/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="index.html">esp_idf_sys</a>::<wbr><a class="fn" href="#">psa_aead_update</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/esp_idf_sys/home/runner/work/esp-idf-hal/esp-idf-hal/target/riscv32imc-esp-espidf/debug/build/esp-idf-sys-62f8a83bf117f72c/out/bindings.rs.html#33392-33399">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub unsafe extern &quot;C&quot; fn psa_aead_update(
    operation: *mut <a class="type" href="type.psa_aead_operation_t.html" title="type esp_idf_sys::psa_aead_operation_t">psa_aead_operation_t</a>,
    input: *const u8,
    input_length: usize,
    output: *mut u8,
    output_size: usize,
    output_length: *mut usize
) -&gt; <a class="type" href="type.psa_status_t.html" title="type esp_idf_sys::psa_status_t">psa_status_t</a></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Encrypt or decrypt a message fragment in an active AEAD operation.</p>
<p>Before calling this function, you must:</p>
<ol>
<li>Call either psa_aead_encrypt_setup() or psa_aead_decrypt_setup().
The choice of setup function determines whether this function
encrypts or decrypts its input.</li>
<li>Set the nonce with psa_aead_generate_nonce() or psa_aead_set_nonce().</li>
<li>Call psa_aead_update_ad() to pass all the additional data.</li>
</ol>
<p>If this function returns an error status, the operation enters an error
state and must be aborted by calling psa_aead_abort().</p>
<p>\warning When decrypting, until psa_aead_verify() has returned #PSA_SUCCESS,
there is no guarantee that the input is valid. Therefore, until
you have called psa_aead_verify() and it has returned #PSA_SUCCESS:
- Do not use the output in any way other than storing it in a
confidential location. If you take any action that depends
on the tentative decrypted data, this action will need to be
undone if the input turns out not to be valid. Furthermore,
if an adversary can observe that this action took place
(for example through timing), they may be able to use this
fact as an oracle to decrypt any message encrypted with the
same key.
- In particular, do not copy the output anywhere but to a
memory or storage space that you have exclusive access to.</p>
<p>This function does not require the input to be aligned to any
particular block boundary. If the implementation can only process
a whole block at a time, it must consume all the input provided, but
it may delay the end of the corresponding output until a subsequent
call to psa_aead_update(), psa_aead_finish() or psa_aead_verify()
provides sufficient input. The amount of data that can be delayed
in this way is bounded by #PSA_AEAD_UPDATE_OUTPUT_SIZE.</p>
<p>\param[in,out] operation     Active AEAD operation.
\param[in] input             Buffer containing the message fragment to
encrypt or decrypt.
\param input_length          Size of the \p input buffer in bytes.
\param[out] output           Buffer where the output is to be written.
\param output_size           Size of the \p output buffer in bytes.
This must be appropriate for the selected
algorithm and key:
- A sufficient output size is
#PSA_AEAD_UPDATE_OUTPUT_SIZE(\c key_type,
\c alg, \p input_length) where
\c key_type is the type of key and \c alg is
the algorithm that were used to set up the
operation.
- #PSA_AEAD_UPDATE_OUTPUT_MAX_SIZE(\p
input_length) evaluates to the maximum
output size of any supported AEAD
algorithm.
\param[out] output_length    On success, the number of bytes
that make up the returned output.</p>
<p>\retval #PSA_SUCCESS
Success.
\retval #PSA_ERROR_BUFFER_TOO_SMALL
The size of the \p output buffer is too small.
#PSA_AEAD_UPDATE_OUTPUT_SIZE(\c key_type, \c alg, \p input_length) or
#PSA_AEAD_UPDATE_OUTPUT_MAX_SIZE(\p input_length) can be used to
determine the required buffer size.
\retval #PSA_ERROR_INVALID_ARGUMENT
The total length of input to psa_aead_update_ad() so far is
less than the additional data length that was previously
specified with psa_aead_set_lengths(), or
the total input length overflows the plaintext length that
was previously specified with psa_aead_set_lengths().
\retval #PSA_ERROR_INSUFFICIENT_MEMORY \emptydescription
\retval #PSA_ERROR_COMMUNICATION_FAILURE \emptydescription
\retval #PSA_ERROR_HARDWARE_FAILURE \emptydescription
\retval #PSA_ERROR_CORRUPTION_DETECTED \emptydescription
\retval #PSA_ERROR_STORAGE_FAILURE \emptydescription
\retval #PSA_ERROR_BAD_STATE
The operation state is not valid (it must be active, have a nonce
set, and have lengths set if required by the algorithm), or the
library has not been previously initialized by psa_crypto_init().
It is implementation-dependent whether a failure to initialize
results in this error code.</p>
</div></details></section></div></main></body></html>