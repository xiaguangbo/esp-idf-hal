<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="\brief Inject an initial entropy seed for the random generator into secure storage."><title>mbedtls_psa_inject_entropy in esp_idf_sys - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-e935ef01ae1c1829.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="esp_idf_sys" data-themes="" data-resource-suffix="" data-rustdoc-version="1.78.0-nightly (3406ada96 2024-02-21)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-4c98445ec4002617.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-c37d3936c59ababd.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../esp_idf_sys/index.html">esp_idf_sys</a><span class="version">0.34.1</span></h2></div><div class="sidebar-elems"></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../esp_idf_sys/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="index.html">esp_idf_sys</a>::<wbr><a class="fn" href="#">mbedtls_psa_inject_entropy</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/esp_idf_sys/home/runner/work/esp-idf-hal/esp-idf-hal/target/riscv32imc-esp-espidf/debug/build/esp-idf-sys-62f8a83bf117f72c/out/bindings.rs.html#36851">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub unsafe extern &quot;C&quot; fn mbedtls_psa_inject_entropy(
    seed: *const u8,
    seed_size: usize
) -&gt; <a class="type" href="type.psa_status_t.html" title="type esp_idf_sys::psa_status_t">psa_status_t</a></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>\brief Inject an initial entropy seed for the random generator into
secure storage.</p>
<p>This function injects data to be used as a seed for the random generator
used by the PSA Crypto implementation. On devices that lack a trusted
entropy source (preferably a hardware random number generator),
the Mbed PSA Crypto implementation uses this value to seed its
random generator.</p>
<p>On devices without a trusted entropy source, this function must be
called exactly once in the lifetime of the device. On devices with
a trusted entropy source, calling this function is optional.
In all cases, this function may only be called before calling any
other function in the PSA Crypto API, including psa_crypto_init().</p>
<p>When this function returns successfully, it populates a file in
persistent storage. Once the file has been created, this function
can no longer succeed.</p>
<p>If any error occurs, this function does not change the system state.
You can call this function again after correcting the reason for the
error if possible.</p>
<p>\warning This function <strong>can</strong> fail! Callers MUST check the return status.</p>
<p>\warning If you use this function, you should use it as part of a
factory provisioning process. The value of the injected seed
is critical to the security of the device. It must be
<em>secret</em>, <em>unpredictable</em> and (statistically) <em>unique per device</em>.
You should be generate it randomly using a cryptographically
secure random generator seeded from trusted entropy sources.
You should transmit it securely to the device and ensure
that its value is not leaked or stored anywhere beyond the
needs of transmitting it from the point of generation to
the call of this function, and erase all copies of the value
once this function returns.</p>
<p>This is an Mbed TLS extension.</p>
<p>\note This function is only available on the following platforms:</p>
<ul>
<li>If the compile-time option MBEDTLS_PSA_INJECT_ENTROPY is enabled.
Note that you must provide compatible implementations of
mbedtls_nv_seed_read and mbedtls_nv_seed_write.</li>
<li>In a client-server integration of PSA Cryptography, on the client side,
if the server supports this feature.
\param[in] seed          Buffer containing the seed value to inject.
\param[in] seed_size     Size of the \p seed buffer.
The size of the seed in bytes must be greater
or equal to both #MBEDTLS_ENTROPY_BLOCK_SIZE
and the value of \c MBEDTLS_ENTROPY_MIN_PLATFORM
in <code>library/entropy_poll.h</code> in the Mbed TLS source
code.
It must be less or equal to
#MBEDTLS_ENTROPY_MAX_SEED_SIZE.</li>
</ul>
<p>\retval #PSA_SUCCESS
The seed value was injected successfully. The random generator
of the PSA Crypto implementation is now ready for use.
You may now call psa_crypto_init() and use the PSA Crypto
implementation.
\retval #PSA_ERROR_INVALID_ARGUMENT
\p seed_size is out of range.
\retval #PSA_ERROR_STORAGE_FAILURE
There was a failure reading or writing from storage.
\retval #PSA_ERROR_NOT_PERMITTED
The library has already been initialized. It is no longer
possible to call this function.</p>
</div></details></section></div></main></body></html>